clc; clear; format long ; fid=fopen('vof2.dat','w');

%% For Lambda  L varies from 2:0.1:10
x=[1:0.5:10]';

% expo balking ens expo dist.
%y=[0.894413055	0.981408868	1.070510383	1.162041992	1.256326118	1.353689447	1.454466952	1.559004231	1.667658481	1.780798246	1.898802015	2.022055679	2.150948848	2.285870027	2.427200667	2.575308156	2.730537858	2.893204376	3.063582292	3.241896703	3.428313939	3.622932913	3.825777544	4.036790743	4.25583036	4.482667425	4.716986926	4.958391175	5.206405709	5.46048746	5.720034845	5.984399258	6.252897422	6.524824013	6.799463994	7.07610416	7.354043516	7.632602183	7.911128684	8.189005565	8.465653405	8.740533346	9.013148345	9.283043353	9.549804663	9.813058647	10.07247007	10.32774017	10.57860463	10.8248315	11.06621929	11.30259502	11.53381252	11.7597508	11.98031253	12.19542266	12.40502709	12.6090914	12.80759965	13.00055316	13.18796938	13.36988067	13.54633317	13.71738561	13.88310817	14.04358135	14.1988948	14.34914628	14.49444052	14.63488825	14.77060518	14.90171106	15.02832885	15.15058384	15.26860293	15.38251392	15.49244489	15.59852361	15.70087706	15.79963093	15.8949093	15.98683421	16.07552546	16.16110028	16.24367318	16.32335576	16.40025661	16.47448117	16.54613171	16.61530724	16.68210353
%]'; 

%  expo balking ens E3 dist.
%y=[1.062758488	1.178342123	1.296920296	1.418453171	1.542889419	1.670176412	1.800268275	1.933132366	2.068754542	2.207143406	2.34833367	2.492388692	2.639402188	2.789499075	2.942835361	3.099596971	3.259997396	3.42427404	3.592683186	3.765493542	3.9429784	4.12540653	4.313032038	4.506083513	4.704752908	4.90918465	5.119465558	5.335616134	5.557583771	5.785238306	6.018370251	6.256691827	6.499840775	6.747386706	6.998839625	7.253660106	7.511270545	7.771066895	8.032430308	8.294738187	8.55737426	8.819737381	9.081248917	9.341358648	9.599549241	9.855339379	10.10828572	10.35798386	10.60406844	10.84621269	11.0841274	11.31755959	11.54629092	11.770136	11.98894053	12.20257946	12.41095516	12.61399553	12.81165223	13.00389884	13.1907292	13.37215566	13.54820744	13.71892906	13.88437878	14.04462712	14.19975542	14.34985451	14.49502339	14.63536803	14.77100019	14.90203639	15.02859689	15.15080478	15.26878514	15.38266428	15.49256904	15.59862619	15.70096187	15.79970112	15.89496743	15.9868824	16.07556543	16.16113347	16.24370076	16.32337871	16.40027572	16.47449711	16.54614501	16.61531835	16.68211282
%]';
%  expo balking ens D dist.
%y=[1.208485354	1.35613914	1.509581546	1.668420842	1.832185574	2.000344526	2.172325337	2.3475318	2.525359872	2.705212499	2.886513395	3.068719978	3.251335583	3.433921017	3.616105389	3.797596027	3.978187182	4.157767135	4.336323262	4.513944611	4.690821528	4.867241975	5.043584238	5.2203059	5.397929098	5.577022353	5.758179464	5.941996236	6.129046064	6.319855535	6.514881393	6.714490139	6.918941483	7.128376583	7.342811708	7.562137521	7.786123802	8.014429015	8.246613828	8.482157509	8.720475992	8.960940501	9.202895695	9.445676526	9.688623193	9.931093851	10.1724749	10.41218891	10.64970023	10.88451874	11.11620172	11.3443545	11.56862984	11.78872655	12.00438752	12.21539728	12.42157933	12.62279333	12.81893228	13.00991968	13.19570674	13.37626981	13.55160775	13.72173964	13.88670242	14.04654885	14.20134551	14.35117096	14.49611404	14.63627231	14.77175061	14.90265972	15.02911519	15.15123622	15.2691447	15.3829643	15.4928197	15.5988359	15.70113755	15.7998485	15.89509124	15.98698657	16.07565321	16.16120754	16.24376337	16.32343171	16.40032065	16.47453525	16.54617745	16.61534598	16.68213639
%]';
% Exponential Balking and Erlang-3 Distribution
y=[1.058970688	0.684849023	0.489933852	0.396643782	0.346624446	0.316236458	0.295932355	0.281404255	0.270477587	0.261947188	0.255093384	0.249460046	0.244743875	0.240735134	0.237284003	0.234280504	0.231642016	0.22930522	0.227220744
]';


%y=[0.684849023	0.489933852	0.396643782	0.346624446	0.316236458	0.295932355	0.281404255	0.270477587	0.261947188	0.255093384	0.249460046	0.244743875	0.240735134	0.237284003	0.234280504	0.231642016	0.22930522	0.227220744	0.2253495	0.223660132	0.222127177	0.22072974	0.219450511	0.21827502	0.217191077	0.216188339	0.215257971	0.214392378	0.213584998	0.212830128	0.21212279	0.211458616	0.210833761	0.210244824	0.209688785	0.209162956	0.208664934	0.208192565
%]';
%% M varies from 1:0.5:15
%x=[1:0.5:15]';

%Const Balking and Exponential Distribution
% y=[9.109761881 8.101123982 7.110689994 6.157558857 5.26925216 4.472563883 3.784051011 3.206519597 2.731748436 2.345659413 2.03272284 1.778543692 ...
%     1.570922707 1.400017231 1.258092948 1.13914929 1.038550841 0.952713377 0.87885385 0.814797965 0.758834631 0.709606681 0.666028953 0.627226767 ...
%     0.592489515 0.561235457 0.532984849 0.507339273 0.483965641]';
% Const Balking and Erlang-3 Distribution  
% y=[13.82210345 12.84808825 11.85104647 10.84087211 9.830098543 8.832927915 7.866017567 6.948044519 6.097217075 5.327818734 4.647669168 4.057614544 ...
%     3.552815131 3.1248492 2.76372869 2.459372114 2.202472311 1.98488991 1.799743135 1.64133342 1.504999381 1.386952389 1.284120564 1.194012322 ...
%     1.114602257 1.044238174 0.981566488 0.925472881 0.875035288]';

% Exponential Balking and Exp Distribution
% y=[9.541086924 9.012098346 8.495621744 7.991473546 7.499837016 7.021379609 6.55731652 6.109371635 5.679620892 5.270246174 4.883258669 4.520256181 ...
%     4.182260981 3.869655576 3.582206972 3.319153827 3.079326609 2.861275077 2.6633854 2.483977419 2.321379009 2.173978594 2.040259046 1.918816893 ...
%     1.808370654 1.707761588 1.615949464 1.532005322 1.455102631]';

% Exponential Balking and Erlang-3 Distribution
% y=[11.58308838 11.15029731 10.73155709 10.32615445 9.933408996 9.552692796 9.183440152 8.825152635 8.477402278 8.139834132 7.812168022 7.494198668 ...
%     7.185793204 6.886885381 6.597466238 6.31757161 6.047267308 5.786633146 5.535747087 5.294670697 5.063436868 4.842040432 4.630431947 4.428514614 ...
%     4.236144043 4.053130399 3.879242388 3.714212529 3.557743172]';


%% to train the given data [x,y]
trnData=[x,y];

%% type of membership function

numMFs=5;%(no. of membership function)
%mfType='trapmf';%(types of membership function: Trapezoidal-shaped membership function
mfType='gaussmf';%(types of membership function: Gaussian curve membership function
%mfType='gbellmf';%(types of membership function :Generalized bell-shaped membership function
%mfType='trimf';%(types of membership function: Triangular-shaped membership function
%%
epoch_n=5;
in_fismat=genfis1(trnData,numMFs,mfType);
out_fismat=anfis(trnData, in_fismat, 7);
[out_fismat,t_error, stepsize, c_fismat,c_error]=anfis(trnData,in_fismat,[],[],[],1);
plotmf(in_fismat,'input',1);

%plot(x,y,x,evalfis(x,out_fismat));
%legend('Training Data','ANFIS Output');
evalfis(x,out_fismat);
showfis(in_fismat);
fprintf(fid,'\n%d\t%d',x,evalfis(x,out_fismat))
fclose (fid)

%% outpur ANFIS
ANFIS_Results = evalfis(x,out_fismat)
mseValue = mean(((y - ANFIS_Results)).^2);                        % Mean Squared Error (MSE)
maeValue = mean(abs(y - ANFIS_Results));                         % Compute mean absolute error (MAE)
rmseValue = sqrt(mseValue);  
%E=immse(y,yPredicted);% Root Mean Squared Error (RMSE)
ssr = sum((y-ANFIS_Results).^2);                         % Regression Sum of Squares
sst = sum((y - mean(y)).^2);  
rSquared = (1 - (ssr / sst)).*100;
R1 = sum((y - mean(y)).*(ANFIS_Results-mean(ANFIS_Results)));
R2 = sum((y - mean(y)).^2)*sum((ANFIS_Results-mean(ANFIS_Results)).^2);
RO = R1/sqrt(R2); %linear correlation coefficient (ro)
Var = mean((y - mean(y)).^2); % Variance
std= sqrt(Var); % standere davition
NDEI = rmseValue / std; % Nondimensional error
VAF1 = sum(((y-ANFIS_Results)-mean(y-ANFIS_Results)).^2);
VAF2 = sum(y-mean(y).^2);
VAF = (1-(VAF1/VAF2)).*100; %percentile variance

Error1 = abs(y-ANFIS_Results)./y;
Error = mean(Error1);
ee=100-Error;

HH=[maeValue,mseValue,rmseValue,rSquared,RO ,ee, VAF, NDEI]';
%% Compare the ANFIS output with the training data.
%plot(x,y,x,evalfis(x,out_fismat) )
%legend('Training Data','ANFIS Output')
%%
%%Plot the ANFIS output and training data.
%end('Training Data','ANFIS Output','Location','NorthWest')

%%Plot the training error and the validation error
%plot(x,t_error,'.b',x,c_error,'*r')